## 1、python实现单例模式



单例模式是指让一个类只能创建出唯一的实例。

用**装饰器**和**元类**这两种方式来实现单例模式，因为这两种方式的通用性最强


##  2、装饰器
本质上是一个python函数。它经常用于有**切面需求**的场景。比如：插入日志、性能测试、事务处理、缓存、权限校验等
**作用：**
它能使函数的功能得到扩充，而同时不用修改函数本身的代码。
它能够增加函数执行前、执行后的行为，而不需对调用函数的代码做任何改变。

```python

# 为函数添加一个统计运行时长的功能
import time
import threading
 
def how_much_time(func):
    def inner():
        t_start = time.time()
        func()
        t_end = time.time()
        print("一共花费了{0}秒时间".format(t_end - t_start, ))
    return inner
    # 将增加的新功能代码以及被装饰函数运行代码func()一同打包返回，返回的是一个内部函数，这个被返回的函数就是装饰器
 
def sleep_5s():
    time.sleep(5)
    print("%d秒结束了" % (5,))
 
def sleep_6s():
    time.sleep(6)
    print("%d秒结束了" % (6,))
 
sleep_5s = how_much_time(sleep_5s)
# 因为sleep_5s函数的功能就是睡5秒钟，虽然增加了统计运行时间的功能，但是他本身功能没变(还是睡5秒钟)，所以仍然用原来函数名接收增加功能了的自己
sleep_6s = how_much_time(sleep_6s)
 
t1 = threading.Thread(target=sleep_5s)
t2 = threading.Thread(target=sleep_6s)
t1.start()
t2.start()
# 5秒结束了
# 一共花费了5.014161109924316秒时间
# 6秒结束了
# 一共花费了6.011810302734375秒时间
```

语法糖写法：

```python
# 为函数添加一个统计运行时长的功能
import time
import threading
 
def how_much_time(func):
    def inner():
        t_start = time.time()
        func()
        t_end = time.time()
        print("一共花费了{0}秒时间".format(t_end - t_start, ))
 
    return inner
 
 
@how_much_time
# @how_much_time等价于sleep_5s = how_much_time(sleep_5s)
def sleep_5s():
    time.sleep(5)
    print("%d秒结束了" % (5,))
 
@how_much_time
def sleep_6s():
    time.sleep(6)
    print("%d秒结束了" % (6,))
 
t1 = threading.Thread(target=sleep_5s)
t2 = threading.Thread(target=sleep_6s)
t1.start()
t2.start()
 
```

## 3、pytho垃圾回收机制

一、引子

我们定义变量会申请[内存](https://so.csdn.net/so/search?q=内存&spm=1001.2101.3001.7020)空间来存放变量的值，而内存的容量是有限的，**当一个变量值没有用了(简称垃圾)就应该将其占用的内存空间给回收掉，而变量名是访问到变量值的唯一方式，所以当一个变量值没有关联任何变量名时，我们就无法再访问到该变量值了，该变量值就是一个垃圾会被python解释的垃圾回收机制自动回收**

二、什么是垃圾回收机制

垃圾回收机制(简称GC)是python解释器自带的一种机制，专门用来回收不可用的变量值所占用的内存空间

三、为什么要用垃圾回收机制

程序运行过程中会申请大量的内存空间，为对于一些无用的内存空间如果不及时清理的话会导致内存使用殆尽(内存的益出)，导致程序的崩溃，因此管理内存是一件非常重要而繁杂的事情，而python解释器自带的垃圾回收机制把程序员从繁杂的内存管理中解放出来

四、垃圾回收机制原理分析

python的GC模块主要运用了**“引用计数”(reference counting)**来跟踪和回收垃圾，在引用计数的基础上，还可以通过“**标记-清楚**”(Mark and sweep)解决容器对象可能产生的循环引用问题，并且通过“**分代回收**”(generation collection)以空间换取时间的方式来进一步提高垃圾回收的效率

​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

**python垃圾回收机制以引用计数为主，标记-清除和分代回收为辅。**

**引用计数**：Python在内存中存储每个对象的引用计数，对象被引用了计数加一，对象被释放了，计数减一，如果计数变成0，该对象就会消失，分配给该对象的内存就会释放出来。

```
引用计数就是：变量值被变量名关联的次数

如：name=“maple”

变量值maple被关联了一个name，称之为引用计数为1，

引用计数增加：

x=10(此时,变量值10的引用计数为1)

y=10(此时,把x的内存地址给了y,此时,x,y都关联了10,所以变量值10的引用计数为2)

引用计数减少：

x=3(此时，x与10解除了关联，与3建立了关联，变量10的引用计数为1)

del y (del的意思是解除变量名y与变量值10的关联关系，此时，变量10的引用计数为0)

这样变量值10的引用计数为0，其占用的内存地址就会被回收
```



**标记-清除**：是一种基于追踪回收(tracing GC)技术实现的垃圾回收算法。它分为两个阶段：第一阶段是标记阶段，GC会把所有的活动对象打上标记，第二阶段是把那些没有标记的对象非活动对象进行回收。对象之间通过引用(指针)连在一起，构成一个有向图，对象构成这个有向图的节点，而引用关系构成这个有向图的边。从根对象(root object)出发，沿着有向边遍历对象，可达的(reachable)对象标记为活动对象，不可达的对象就是要被清除的非活动对象。根对象就是全局变量、调用栈、寄存器。主要处理容器对象

**分代回收**：

==在多次扫描的情况下，都没有被回收的变量，GC机制就会认为，该变量是常用变量，GC对其扫描的频率会降低==

Python将内存根据对象的存活时间划分为不同的集合，每个集合称为一个代，Python将内存分为了3“代”，分别为年轻代(第0代)、中年代(第1代)、老年代(第2代)，他们对应的是3个链表，它们的垃圾收集频率与对象的存活时间的增大而减小。新创建的对象都会分配在年轻代，年轻代链表的总数达到上限时，Python垃圾收集机制就会被触发，把那些可以被回收的对象回收掉，而那些不会回收的对象就会被移到中年代去，依此类推，老年代中的对象是存活时间最久的对象，甚至是存活于整个系统的生命周期内。



## 4、lambda 表达式

简单来说，lambda表达式通常是当你需要使用一个函数，但是又不想费脑袋去命名一个函数的时候使用，也就是通常所说的匿名函数。

lambda表达式一般的形式是：关键词lambda后面紧接一个或多个参数，紧接一个冒号“：”，紧接一个表达式。lambda表达式是一个表达式不是一个语句。

```python
def add(x, y):
    return x+ y
print(add(1,2))

### 匿名函数
add = lambda x,y:x+y 
print(add(1,2))
```



## 5、Python多线程





## 6、Python深浅拷贝



































































